<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solid Adaptive 1440 - Deep Violet</title>
  <style>
    :root {
      --bg-color: #121214;
      --card-bg: #1c1c1f;
      --text-main: #ffffff;
      --text-sub: #949499;
      --border-color: rgba(255, 255, 255, 0.08);
      --accent-color: #00e5ff; 
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      min-height: 100vh;
      background: var(--bg-color);
      color: var(--text-main);
      display: grid;
      place-items: center;
      overflow: hidden;
    }

    .minute-dock {
      position: relative;
      width: min(360px, 92vw);
      aspect-ratio: 1 / 1;
    }

    .minute-card {
      position: absolute; inset: 0;
      border-radius: 50%;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      display: grid;
      place-items: center;
    }

    .labels {
      position: absolute; inset: 0;
      pointer-events: none;
    }

    .label {
      position: absolute;
      transform: translate(-50%, -50%);
      font-size: 15px;
      font-weight: 600;
      color: var(--text-main);
      background: rgba(25, 25, 28, 0.95); /* 少しだけ濃くして高級感を */
      padding: 2px 6px;
      border-radius: 4px;
      font-variant-numeric: tabular-nums;
      z-index: 10;
    }

    .center {
      position: absolute;
      text-align: center;
      pointer-events: none;
    }

    .remain {
      font-size: clamp(65px, 16vw, 92px);
      font-weight: 800;
      line-height: 1;
    }

    .unit {
      font-size: 11px;
      margin-top: 8px;
      color: var(--text-sub);
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    svg { width: 100%; height: 100%; }

    .track {
      fill: none;
      stroke: rgba(255, 255, 255, 0.04);
      stroke-width: 14;
    }

    .remainPath {
      fill: none;
      stroke: var(--accent-color);
      stroke-width: 14;
      stroke-linecap: round;
      transition: stroke 1.5s ease; /* 色の変化をより滑らかに */
    }

    .ticks line {
      stroke: rgba(255, 255, 255, 0.15);
    }
  </style>
</head>
<body>

  <div class="minute-dock">
    <div class="minute-card">
      <svg viewBox="0 0 200 200">
        <g class="ticks" id="ticks"></g>
        <circle class="track" cx="100" cy="100" r="78"></circle>
        <path class="remainPath" id="remainPath"
          d="M 100 22
             A 78 78 0 1 1 100 178
             A 78 78 0 1 1 100 22" />
      </svg>
      <div class="labels" id="labels"></div>
      <div class="center">
        <div>
          <div class="remain" id="remain">----</div>
          <div class="unit">Minutes Remaining</div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const elRemain = document.getElementById('remain');
  const path = document.getElementById('remainPath');
  const labelsEl = document.getElementById('labels');
  const ticks = document.getElementById('ticks');
  const C = path.getTotalLength();

  function updateTheme(hour) {
    let color;
    if (hour >= 5 && hour < 16) {
      color = "#00e5ff"; // 日中：スカイブルー
    } else if (hour >= 16 && hour < 20) {
      color = "#ff9100"; // 夕方：オレンジ
    } else {
      // 夜間：より暗く深いダークバイオレットに変更
      color = "#6a00cc"; 
    }
    document.documentElement.style.setProperty('--accent-color', color);
  }

  function renderLabels(){
    labelsEl.innerHTML = '';
    const w = labelsEl.offsetWidth;
    const h = labelsEl.offsetHeight;
    const cx = w / 2, cy = h / 2;
    const r = Math.min(w, h) * 0.39;

    for (let i = 0; i < 12; i++){
      const value = 1440 - i * 120;
      const angle = (i / 12) * 360; 
      const rad = (angle - 90) * Math.PI / 180;
      const d = document.createElement('div');
      d.className = 'label';
      d.textContent = value;
      d.style.left = `${cx + r * Math.cos(rad)}px`;
      d.style.top = `${cy + r * Math.sin(rad)}px`;
      labelsEl.appendChild(d);
    }
  }

  for (let h = 0; h < 24; h++) {
    const angle = (h / 24) * 360;
    const a = (angle - 90) * Math.PI / 180;
    const rOuter = 92;
    const rInner = h % 6 === 0 ? 78 : 86;
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", 100 + rInner * Math.cos(a));
    line.setAttribute("y1", 100 + rInner * Math.sin(a));
    line.setAttribute("x2", 100 + rOuter * Math.cos(a));
    line.setAttribute("y2", 100 + rOuter * Math.sin(a));
    line.setAttribute("stroke-width", h % 6 === 0 ? "2.5" : "1.5");
    ticks.appendChild(line);
  }

  function tick(){
    const now = new Date();
    const hour = now.getHours();
    const minsSince = hour * 60 + now.getMinutes();
    let remaining = 1440 - minsSince;
    if (remaining <= 0) remaining = 1440;

    elRemain.textContent = remaining;
    updateTheme(hour);

    const frac = remaining / 1440;
    let visible = C * frac;
    path.style.strokeDasharray = `${visible} ${C - visible}`;
    path.style.strokeDashoffset = String(visible);
  }

  renderLabels();
  tick();
  setInterval(tick, 1000);
  window.addEventListener('resize', () => requestAnimationFrame(renderLabels));
})();
</script>
</body>
</html>
